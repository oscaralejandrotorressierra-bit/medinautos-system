<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">

    <!-- ======================================
         TÍTULO DINÁMICO POR PÁGINA
         Cada vista puede sobreescribirlo
    ====================================== -->
    <title>{% block title %}MedinAutos{% endblock %}</title>

    <!-- ======================================
         CSS PRINCIPAL DEL SISTEMA
         Estilos generales (layout, sidebar, etc.)
    ====================================== -->
    <link rel="stylesheet" href="/static/css/main.css">

    <!-- ======================================
         FONT AWESOME (ICONOS)
         Usado en sidebar, botones y acciones
    ====================================== -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- ======================================
         CSS ESPECÍFICO POR MÓDULO
         (vehículos, clientes, dashboard, etc.)
    ====================================== -->
    {% block extra_css %}{% endblock %}
</head>

<body>

    {# ======================================================
    DETECTAR SI HAY SESIÓN ACTIVA
    Se valida con la cookie access_token
    Si existe → se muestra el sidebar
    ====================================================== #}
    {% set autenticado = request.cookies.get('access_token') %}

    {% if autenticado %}
    <!-- ======================================
         SIDEBAR PRINCIPAL
         Visible solo si el usuario está logueado
    ====================================== -->
    <aside class="sidebar">

        <div class="sidebar-logo">
            <a href="/dashboard">MedinAutos</a>
        </div>

        <nav class="sidebar-nav">

            <p class="sidebar-section">PRINCIPAL</p>
            <a href="/dashboard" class="sidebar-item">
                <span class="icon-box"><i class="fa-solid fa-gauge"></i></span>
                Dashboard
            </a>

            <p class="sidebar-section">FLOTA</p>
            <a href="/clientes" class="sidebar-item">
                <span class="icon-box"><i class="fa-solid fa-users"></i></span>
                Clientes
            </a>

            <a href="/vehiculos" class="sidebar-item">
                <span class="icon-box"><i class="fa-solid fa-car"></i></span>
                Vehículos
            </a>

            <div class="sidebar-spacer"></div>

            <a href="/logout" class="sidebar-item logout">
                <span class="icon-box"><i class="fa-solid fa-right-from-bracket"></i></span>
                Salir
            </a>

        </nav>
    </aside>
    {% endif %}


    <!-- ======================================
     ÁREA DE TRABAJO (LAYOUT NUEVO)
====================================== -->
    <main class="app-layout">

        <!-- ===== HEADER SUPERIOR ===== -->
        <header class="topbar">

            <div class="topbar-left">
                <span class="breadcrumb">
                    Inicio / {% block section %}{% endblock %}
                </span>
                <h1 class="page-title">
                    {% block page_title %}{% endblock %}
                </h1>
            </div>

            <div class="topbar-right">
                <div class="user-box">
                    <strong>Admin</strong>
                    <span>MedinAutos</span>
                </div>
            </div>

        </header>

        <!-- ===== CONTENIDO CENTRAL ===== -->
        <section class="content-wrapper">
            <div class="content-card">
                {% block content %}{% endblock %}
            </div>
        </section>

    </main>


    <!-- ======================================
         FOOTER
    ====================================== -->
    <footer class="main-footer">
        <p>© 2025 MedinAutos · Todos los derechos reservados</p>
    </footer>

    <!-- ======================================
         SWEETALERT2 (GLOBAL)
         Disponible para todo el sistema
         Confirmaciones, alertas, éxito, error
    ====================================== -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- ======================================
         JS ESPECÍFICO POR MÓDULO
         (vehiculos.js, clientes.js, etc.)
    ====================================== -->
    {% block extra_js %}{% endblock %}

</body>

</html>